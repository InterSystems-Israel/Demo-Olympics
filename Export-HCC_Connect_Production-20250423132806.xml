<?xml version="1.0" encoding="UTF-8"?>
<Export generator="IRIS" version="26" zv="IRIS for UNIX (Red Hat Enterprise Linux 9 for x86-64) 2024.1.0HCCUX (Build 193U)" ts="2025-04-23 13:28:36">
<Class name="Demolympics.Adapter.CloudStorageInboundAdapter">
<ClassType/>
<ProcedureBlock>1</ProcedureBlock>
<Super>EnsLib.CloudStorage.InboundAdapter</Super>
<System>4</System>
<TimeChanged>67301,52688.755670972</TimeChanged>
<TimeCreated>67301,52688.755670972</TimeCreated>
<Inheritance>right</Inheritance>

<UDLText name="T">
<Content><![CDATA[
// Property PresignedUrl As %String(MAXLEN = 10000);

]]></Content>
</UDLText>

<Property name="SubdirectoryLevels">
<Description><![CDATA[
Presigned URL <br>
All other settings will be ignored if a Presigned URL is provided.]]></Description>
<Type>%Integer</Type>
<InitialExpression>-1</InitialExpression>
<Parameter name="MINVAL" value="-1"/>
</Property>

<Property name="AppendTimestamp">
<Type>%Boolean</Type>
<InitialExpression>0</InitialExpression>
</Property>

<Property name="ArchiveBucket">
<Type>%String</Type>
<Parameter name="MAXLEN" value="1000"/>
</Property>

<Property name="ArchiveFolder">
<Type>%String</Type>
<Parameter name="MAXLEN" value="1000"/>
</Property>

<Property name="ErrorBucket">
<Type>%String</Type>
<Parameter name="MAXLEN" value="1000"/>
</Property>

<Property name="ErrorFolder">
<Type>%String</Type>
<Parameter name="MAXLEN" value="1000"/>
</Property>

<Method name="CreateInboundInput">
<FormalSpec>pInput:%Net.Remote.Object</FormalSpec>
<ReturnType>EnsLib.CloudStorage.InboundInput</ReturnType>
<Implementation><![CDATA[
	Set input = ##class(EnsLib.CloudStorage.InboundInput).%New()
	Set input.Name = pInput.getName()
	Set input.Meta = pInput.getMeta()
	Set input.Content = pInput.getContent() //.%getall()
	Quit input
]]></Implementation>
</Method>
</Class>


<Class name="Demolympics.Adapter.CloudStorageOutboundAdapter">
<ClassType/>
<ProcedureBlock>1</ProcedureBlock>
<Super>EnsLib.CloudStorage.OutboundAdapter,EnsLib.CloudStorage.Common</Super>
<System>4</System>
<TimeChanged>67301,52688.742895119</TimeChanged>
<TimeCreated>67301,52688.742895119</TimeCreated>
<Inheritance>right</Inheritance>

<Property name="PresignedUrl">
<Description><![CDATA[
Presigned URL <br>
All other settings will be ignored if a Presigned URL is provided.]]></Description>
<Type>%String</Type>
<Parameter name="MAXLEN" value="10000"/>
</Property>
</Class>


<Class name="Demolympics.BO.BucketNdJSON">
<Super>Ens.BusinessOperation</Super>
<TimeChanged>67301,52689.189072394</TimeChanged>
<TimeCreated>67301,52689.189072394</TimeCreated>

<Parameter name="ADAPTER">
<Default>Demolympics.Adapter.CloudStorageOutboundAdapter</Default>
</Parameter>

<Property name="Adapter">
<Type>Demolympics.Adapter.CloudStorageOutboundAdapter</Type>
</Property>

<Parameter name="INVOCATION">
<Default>Queue</Default>
</Parameter>

<Property name="BucketName">
<Description>
Bucket name</Description>
<Type>%String</Type>
<Parameter name="MAXLEN" value="1000"/>
</Property>

<Property name="DirectoryName">
<Type>%String</Type>
</Property>

<Parameter name="SETTINGS">
<Default>BucketName:Cloud Storage,DirectoryName:Cloud Storage</Default>
</Parameter>

<Method name="LoadToCloud">
<FormalSpec>pRequest:Demolympics.MSG.Blob,*pResponse:Ens.StringResponse</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
		#dim tException As %Exception.SystemException
	Set tStatus = $$$OK

	set pResponse=##class(Ens.StringResponse).%New()

	Try {
		set tStream=##class(%Stream.TmpCharacter).%New()
 		while 'pRequest.Content.AtEnd {
 			set str=pRequest.Content.ReadLine()
 			do tStream.Write(str)
 		}
		set tFileName=..DirectoryName_pRequest.Name_".ndjson"
		do tStream.Rewind()
		set obj={}.%FromJSON(tStream.Read())
		set out={}
		set out.resourceType= "Bundle"
		set out.entry=[]
		
		set key="",val=""
		set iter=obj.entry.%GetIterator()
		while iter.%GetNext(.key,.val) {
			if val.fullUrl'="" {

				set resId = $PIECE(val.fullUrl,"/",*)
				set val.request.url = $PIECE(val.request.url,"?",1)
				set val.request.url = val.request.url _ "/" _ resId

				set val.resource.id = resId

				do out.entry.%Push(val)
			}
		}
		set out.identifier = {}
		set out.identifier.system = obj.identifier.system
		set out.identifier.value = obj.identifier.value

		set out.timestamp = obj.timestamp
		set out.type = obj.type
		
		do ..TruncateJSONObject(.out)
		do tStream.Clear()
		do tStream.Write(out.%ToJSON())
		//Set tStatus = ..Adapter.DeleteBlob(..BucketName, tFileName)
		Set tStatus = ..Adapter.UploadBlobFromStream(..BucketName,tFileName,tStream)	 	

	 	if $$$ISERR(tStatus) {
	 		set pResponse.StringValue= $system.Status.GetErrorText(tStatus)
	    }
	  
	} 
	Catch tException {
		Set tStatus = tException.AsStatus()
	 	set pResponse.StringValue=$system.Status.GetErrorText(tStatus)
	}
	Quit tStatus
]]></Implementation>
</Method>

<Method name="TruncateJSONObject">
<ClassMethod>1</ClassMethod>
<FormalSpec><![CDATA[&obj:%DynamicObject]]></FormalSpec>
<Implementation><![CDATA[
	set iter = obj.%GetIterator()

	while iter.%GetNext(.key,.value,.type) {
		if (type="string") {
			if $LENGTH(value)>50 {
				if (value["/") {
					set partialVal = $EXTRACT($PIECE(value,"/",*),1,50)
					set $PIECE(value,"/",*) = partialVal
				} else {
					set value = $EXTRACT(value,1,50)
				}
				do obj.%Set(key,value) //,type)
			}
		} elseif ((type="object")||(type="array")) {
			do ..TruncateJSONObject(.value)
			do obj.%Set(key,value) //,type)
		}
	}
]]></Implementation>
</Method>

<XData name="MessageMap">
<Data><![CDATA[
<MapItems>
<MapItem MessageType="Demolympics.MSG.Blob">
<Method>LoadToCloud</Method>
</MapItem>
</MapItems>
]]></Data>
</XData>
</Class>


<Class name="Demolympics.BO.CloudBucket">
<Super>Ens.BusinessOperation</Super>
<TimeChanged>67301,52689.176789944</TimeChanged>
<TimeCreated>67301,52689.176789944</TimeCreated>

<Parameter name="ADAPTER">
<Default>Demolympics.Adapter.CloudStorageOutboundAdapter</Default>
</Parameter>

<Property name="Adapter">
<Type>Demolympics.Adapter.CloudStorageOutboundAdapter</Type>
</Property>

<Parameter name="INVOCATION">
<Default>Queue</Default>
</Parameter>

<Property name="BucketName">
<Description>
Bucket name</Description>
<Type>%String</Type>
<Parameter name="MAXLEN" value="1000"/>
</Property>

<Parameter name="SETTINGS">
<Default>BucketName:Cloud Storage</Default>
</Parameter>

<Method name="LoadToCloud">
<FormalSpec>pRequest:EnsLib.HL7.Message,*pResponse:Ens.StringResponse</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	#dim tException As %Exception.SystemException
	Set tStatus = $$$OK

	set pResponse=##class(Ens.StringResponse).%New()

	Try {
		set tStream=##class(%Stream.TmpCharacter).%New()
 		set tStatus=pRequest.OutputToLibraryStream(.tStream)
		set tFileName="hl7-in/"_$tr($zdt($h,3,1)," :","_")_".HL7"
		
		//Set tStatus = ..Adapter.DeleteBlob(..BucketName, tFileName)
		Set tStatus = ..Adapter.UploadBlobFromStream(..BucketName,tFileName,tStream)	 	

	 	if $$$ISERR(tStatus) {
	 		set pResponse.StringValue= $system.Status.GetErrorText(tStatus)
	    }
	  
	} 
	Catch tException {
		Set tStatus = tException.AsStatus()
	 	set pResponse.StringValue=$system.Status.GetErrorText(tStatus)
	}
	Quit tStatus
]]></Implementation>
</Method>

<XData name="MessageMap">
<Data><![CDATA[
<MapItems>
<MapItem MessageType="EnsLib.HL7.Message">
<Method>LoadToCloud</Method>
</MapItem>
</MapItems>
]]></Data>
</XData>
</Class>


<Class name="Demolympics.BP.DeviceCustomBP">
<Super>Ens.BusinessProcess</Super>
<TimeChanged>67318,29650.976351889</TimeChanged>
<TimeCreated>67301,52688.706347681</TimeCreated>

<Property name="IncludeFTS">
<Type>%Boolean</Type>
<InitialExpression>0</InitialExpression>
</Property>

<Parameter name="SETTINGS">
<Default>IncludeFTS:FTS</Default>
</Parameter>

<Method name="OnRequest">
<FormalSpec>pRequest:Demolympics.MSG.DeviceStatusRequest,*pResponse:Ens.StringResponse</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
  set patientString = ##class(Ens.Util.FunctionSet).Lookup("MQTT Device to Patient", pRequest.deviceId)
  set firstname = $PIECE(patientString, "|", 1)
  set lastname = $PIECE(patientString, "|", 2)
  set gender = $PIECE(patientString, "|", 3)
  set DoB = $PIECE(patientString, "|", 4)
  set SSN = $PIECE(patientString, "|", 5)

  #; set myPatient = ##class(Demolympics.Data.Patient).DeviceIdIndexOpen(pRequest.deviceId)
  
  set myObservation = ##class(Demolympics.MSG.ObservationRequest).%New()

  set myObservation.FirstName = firstname
  set myObservation.LastName = lastname
  
  //set myObservation.DateOfBirth = myPatient.DateOfBirth
  set myObservation.DateOfBirth = DoB
  
  
  set myObservation.Gender = gender
  set myObservation.DeviceId = pRequest.deviceId
  set myObservation.SSN = SSN


  set intTime1 = $ZDATETIMEH(pRequest.measurementTime,5)
  set intTime2 = $ZDT(intTime1,8)
  set intTime3 =  $REPLACE(intTime2, " ", "")
  set myObservation.measurementTime =  $REPLACE(intTime3, ":", "")


  //set myObservation.measurementTime = pRequest.measurementTime
  set myObservation.heartRate = pRequest.heartRate
  set st = myObservation.%Save()


  set myHL7 = ##class(EnsLib.HL7.Message).%New()
  
  
  //set st = ##class(Demolympics.DTL.ObservationtoORUR01).Transform(myObservation,.myHL7)
  set st = ##class(Demolympics.DTL.ObservationtoADTA08).Transform(myObservation,.myHL7)
  
  //set st = ##class(Demolympics.DTL.MQTTtoORUR01).Transform(pRequest,.myHL7)
  
  //set ^x = st
  Set tStatus = ..SendRequestAsync("To EMR", myHL7, 0)

  If ..IncludeFTS {
    Set tStatus = ..SendRequestAsync("FTS to Bucket", myHL7, 0)
    Set tStatus = ..SendRequestAsync("FTS to FHIR Server", myHL7, 0)
  }
  Return $$$OK
]]></Implementation>
</Method>

<Method name="OnResponse">
<Description>
Handle a 'Response'</Description>
<FormalSpec><![CDATA[request:Ens.StringRequest,&response:Ens.StringResponse,callrequest:%Library.Persistent,callresponse:%Library.Persistent,pCompletionKey:%String]]></FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[    Return $$$OK
]]></Implementation>
</Method>

<Storage name="Default">
<Type>%Storage.Persistent</Type>
<DefaultData>DeviceCustomBPDefaultData</DefaultData>
<Data name="DeviceCustomBPDefaultData">
<Subscript>"DeviceCustomBP"</Subscript>
<Value name="1">
<Value>IncludeFTS</Value>
</Value>
</Data>
</Storage>
</Class>


<Class name="Demolympics.BS.CloudBucket">
<Super>Ens.BusinessService</Super>
<TimeChanged>67301,52689.168622241</TimeChanged>
<TimeCreated>67301,52689.168622241</TimeCreated>

<Parameter name="ADAPTER">
<Default>Demolympics.Adapter.CloudStorageInboundAdapter</Default>
</Parameter>

<UDLText name="T">
<Content><![CDATA[
// Parameter ADAPTER = "EnsLib.CloudStorage.InboundAdapter";

]]></Content>
</UDLText>

<Method name="OnProcessInput">
<FormalSpec>pInput:EnsLib.CloudStorage.InboundInput,*pOutput:%RegisteredObject</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[

	#dim tStatus = $$$OK
	#dim Err as %Exception.AbstractException
	try {
		
		set req=##class(Demolympics.MSG.Blob).%New()
		set req.Meta=pInput.Meta
		set req.Name=$p(pInput.Name,"/",*)
		do req.Content.CopyFrom(pInput.Content)
		set tStatus=..SendRequestAsync("FHIR to OMOP",req)
		If $$$ISERR(tStatus) {
	    	set alert=##class(Ens.AlertRequest).%New()
	    	set alert.AlertText=$SYSTEM.Status.GetErrorText(tStatus)
	    	set tStatus=..SendAlert(alert)
		}
	}
	catch Err {
		set tStatus=Err.AsStatus()
	   	set alert=##class(Ens.AlertRequest).%New()
	   	set alert.AlertText=$SYSTEM.Status.GetErrorText(tStatus)
	   	set tStatus=..SendAlert(alert)
	}
    quit $$$OK
]]></Implementation>
</Method>
</Class>


<Class name="Demolympics.BS.DeviceStatusService">
<Super>Ens.BusinessService,%JSON.Adaptor</Super>
<TimeChanged>67301,52688.686866274</TimeChanged>
<TimeCreated>67301,52688.686866274</TimeCreated>

<Parameter name="ADAPTER">
<Default>EnsLib.MQTT.Adapter.Inbound</Default>
</Parameter>

<Method name="OnProcessInput">
<FormalSpec>pInput:EnsLib.MQTT.Message,pOutput:Ens.StringResponse</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
   $$$TRACE("test123")
   //set ^x = $ZDateTime($H)
   set tsc=$$$OK 

   set DeviceStatusValue = ##class(%DynamicAbstractObject).%FromJSON(pInput.StringValue)
   //set ^steps = DeviceStatusValue.steps
   set DeviceStatus = ##class(Demolympics.MSG.DeviceStatusRequest).%New()
   #; set DeviceStatus.stepsToday = DeviceStatusValue.stepsToday
   #; set DeviceStatus.timeToday = DeviceStatusValue.timeToday
   do DeviceStatus.%JSONImport(DeviceStatusValue)
   #; set DeviceStatus.deviceId = DeviceStatusValue.deviceId
   #; set DeviceStatus.measurementTime = DeviceStatusValue.measurementTime
   #; set DeviceStatus.heartRate = DeviceStatusValue.heartRate

   #; set tsc =..SendRequestSync("Demolympics.MQTTtoHL7BP", DeviceStatus, .Response, -1, "Device Status Process")
   set tsc =..SendRequestSync("Medical Device Process", DeviceStatus, .Response, -1, "Device Status Process")
   set pOutput = Response
   quit tsc
]]></Implementation>
</Method>
</Class>


<Class name="Demolympics.DTL.ObservationtoADTA08">
<Super>Ens.DataTransformDTL</Super>
<TimeChanged>67301,52689.194532226</TimeChanged>
<TimeCreated>67301,52689.194532226</TimeCreated>
<DependsOn>Demolympics.MSG.ObservationRequest,EnsLib.HL7.Message</DependsOn>

<Parameter name="GENERATEEMPTYSEGMENTS">
<Default>0</Default>
</Parameter>

<Parameter name="IGNOREMISSINGSOURCE">
<Default>1</Default>
</Parameter>

<Parameter name="REPORTERRORS">
<Default>1</Default>
</Parameter>

<Parameter name="TREATEMPTYREPEATINGFIELDASNULL">
<Default>0</Default>
</Parameter>

<XData name="DTL">
<XMLNamespace>http://www.intersystems.com/dtl</XMLNamespace>
<Data><![CDATA[
<transform sourceClass='Demolympics.MSG.ObservationRequest' targetClass='EnsLib.HL7.Message' targetDocType='2.3.1:ADT_A01' create='new' language='objectscript' >
<group>
<annotation>MSH</annotation>
<assign value='"Heart Rate Monitor"' property='target.{MSH:SendingApplication}' action='set' />
<assign value='"A"' property='target.{MSH:SendingFacility}' action='set' />
<assign value='"CAR"' property='target.{MSH:ReceivingApplication}' action='set' />
<assign value='..SubString(..CurrentDateTime(),0,19)' property='target.{MSH:DateTimeOfMessage}' action='set' />
<assign value='..ReplaceStr(target.{MSH:DateTimeOfMessage},"-","")' property='target.{MSH:DateTimeOfMessage}' action='set' />
<assign value='..ReplaceStr(target.{MSH:DateTimeOfMessage},":","")' property='target.{MSH:DateTimeOfMessage}' action='set' />
<assign value='..ReplaceStr(target.{MSH:DateTimeOfMessage}," ","")' property='target.{MSH:DateTimeOfMessage}' action='set' />
<assign value='target.{MSH:DateTimeOfMessage}' property='target.{PV1:AdmitDateTime.timeofanevent}' action='set' />
<assign value='target.{MSH:DateTimeOfMessage}' property='target.{PV1:DischargeDateTime.timeofanevent}' action='set' />
<assign value='"ADT^A08"' property='target.{MSH:MessageType}' action='set' />
<assign value='source.measurementTime' property='target.{MSH:MessageControlID}' action='set' />
<assign value='"P"' property='target.{MSH:ProcessingID}' action='set' />
<assign value='"2.3.1"' property='target.{MSH:VersionID}' action='set' />
</group>
<group>
<annotation>EVN</annotation>
<assign value='"A08"' property='target.{EVN:EventTypeCode}' action='set' />
<assign value='target.{MSH:DateTimeOfMessage}' property='target.{EVN:RecordedDateTime.timeofanevent}' action='set' />
</group>
<group>
<annotation>PID</annotation>
<assign value='1' property='target.{PID:SetIDPID}' action='set' />
<assign value='source.DeviceId' property='target.{PID:SSNNumberPatient}' action='set' />
<assign value='"ABC"' property='target.{PID:PatientID.assigningfacility}' action='set' />
<assign value='source.SSN' property='target.{PID:PatientIdentifierList(1).ID}' action='set' />
<assign value='source.SSN' property='target.{PID:AlternatePatientIDPID(1).ID}' action='set' />
<assign value='source.SSN' property='target.{PID:PatientID}' action='set' />
<assign value='source.Gender' property='target.{PID:Sex}' action='set' />
<assign value='source.LastName' property='target.{PID:PatientName(1).familylastname.familyname}' action='set' />
<assign value='source.FirstName' property='target.{PID:PatientName(1).givenname}' action='set' />
<assign value='source.DateOfBirth' property='target.{PID:DateTimeOfBirth.timeofanevent}' action='set' />
</group>
<group>
<annotation>PV1</annotation>
<assign value='1' property='target.{PV1:SetIDPV1}' action='set' />
<assign value='"I"' property='target.{PV1:PatientClass}' action='set' />
<assign value='"H2NW"' property='target.{PV1:AssignedPatientLocation}' action='set' />
<assign value='"001234"' property='target.{PV1:AttendingDoctor(1).IDnumberST}' action='set' />
<assign value='"HOUSE"' property='target.{PV1:AttendingDoctor(1).familylastname.familyname}' action='set' />
<assign value='"GREGORY"' property='target.{PV1:AttendingDoctor(1).givenname}' action='set' />
<assign value='"001234"' property='target.{PV1:ReferringDoctor(1).IDnumberST}' action='set' />
<assign value='"HOUSE"' property='target.{PV1:ReferringDoctor(1).familylastname.familyname}' action='set' />
<assign value='"GREGORY"' property='target.{PV1:ReferringDoctor(1).givenname}' action='set' />
</group>
<group>
<annotation>OBX</annotation>
<assign value='1' property='target.{OBX(1):SetIDOBX}' action='set' />
<assign value='"55417-0"' property='target.{OBX():ObservationIdentifier.identifier}' action='set' />
<assign value='"Blood pressure panel"' property='target.{OBX():ObservationIdentifier.text}' action='set' />
<assign value='"LN"' property='target.{OBX():ObservationIdentifier.nameofcodingsystem}' action='set' />
<assign value='"NM"' property='target.{OBX(1):ValueType}' action='set' />
<assign value='"F"' property='target.{OBX(1):ObservationResultStatus}' action='set' />
<assign value='source.measurementTime' property='target.{OBX(1):DateTimeoftheObservation.timeofanevent}' action='set' />
<assign value='source.heartRate' property='target.{OBX(1):ObservationValue(1)}' action='set' />
<assign value='"BPM"' property='target.{OBX(1):Units}' action='set' disabled='1' />
<assign value='"BPM"' property='target.{OBX(1):Units.text}' action='set' />
<assign value='264864' property='target.{OBX(1):Units.identifier}' action='set' disabled='1' />
</group>
</transform>
]]></Data>
</XData>
</Class>


<Class name="Demolympics.MSG.Blob">
<Super>Ens.Request</Super>
<TimeChanged>67301,52688.682212316</TimeChanged>
<TimeCreated>67301,52688.682212316</TimeCreated>

<Property name="Name">
<Type>%String</Type>
</Property>

<Property name="Meta">
<Type>%String</Type>
</Property>

<Property name="Content">
<Type>%GlobalBinaryStream</Type>
</Property>

<Storage name="Default">
<Type>%Storage.Persistent</Type>
<DefaultData>BlobDefaultData</DefaultData>
<Data name="BlobDefaultData">
<Subscript>"Blob"</Subscript>
<Value name="1">
<Value>Name</Value>
</Value>
<Value name="2">
<Value>Meta</Value>
</Value>
<Value name="3">
<Value>Content</Value>
</Value>
</Data>
</Storage>
</Class>


<Class name="Demolympics.MSG.DeviceStatusRequest">
<Super>Ens.Request,%JSON.Adaptor</Super>
<TimeChanged>67301,52689.52061661</TimeChanged>
<TimeCreated>67301,52689.52061661</TimeCreated>

<Property name="deviceId">
<Type>%String</Type>
</Property>

<Property name="measurementTime">
<Type>%String</Type>
</Property>

<Property name="heartRate">
<Type>%Integer</Type>
</Property>

<Storage name="Default">
<Type>%Storage.Persistent</Type>
<DefaultData>DeviceStatusRequestDefaultData</DefaultData>
<Data name="DeviceStatusRequestDefaultData">
<Subscript>"DeviceStatusRequest"</Subscript>
<Value name="1">
<Value>deviceId</Value>
</Value>
<Value name="2">
<Value>measurementTime</Value>
</Value>
<Value name="3">
<Value>heartRate</Value>
</Value>
</Data>
</Storage>
</Class>


<Class name="Demolympics.MSG.ObservationRequest">
<Super>Ens.Request</Super>
<TimeChanged>67301,52688.68519154</TimeChanged>
<TimeCreated>67301,52688.68519154</TimeCreated>

<Property name="measurementTime">
<Type>%String</Type>
</Property>

<Property name="heartRate">
<Type>%Integer</Type>
</Property>

<Property name="FirstName">
<Type>%String</Type>
</Property>

<Property name="LastName">
<Type>%String</Type>
</Property>

<Property name="DateOfBirth">
<Type>%String</Type>
</Property>

<Property name="Gender">
<Type>%String</Type>
</Property>

<Property name="DeviceId">
<Type>%String</Type>
</Property>

<Property name="SSN">
<Type>%String</Type>
</Property>

<Storage name="Default">
<Type>%Storage.Persistent</Type>
<DefaultData>ObservationRequestDefaultData</DefaultData>
<Data name="ObservationRequestDefaultData">
<Subscript>"ObservationRequest"</Subscript>
<Value name="1">
<Value>measurementTime</Value>
</Value>
<Value name="2">
<Value>heartRate</Value>
</Value>
<Value name="3">
<Value>FirstName</Value>
</Value>
<Value name="4">
<Value>LastName</Value>
</Value>
<Value name="5">
<Value>DateOfBirth</Value>
</Value>
<Value name="6">
<Value>Gender</Value>
</Value>
<Value name="7">
<Value>DeviceId</Value>
</Value>
<Value name="8">
<Value>SSN</Value>
</Value>
</Data>
</Storage>
</Class>


<Project name="EnsExportProduction_2025-04-23 13-28-06_055+0" LastModified="2025-04-23 13:28:36.686241795">
  <ProjectDescription>Studio Project generated from Production 'HCC.Connect.Production' at 2025-04-23 13:28:06.055 UTC</ProjectDescription>
  <Items>
    <ProjectItem name="Demolympics.Adapter.CloudStorageInboundAdapter" type="CLS"></ProjectItem>
    <ProjectItem name="Demolympics.Adapter.CloudStorageOutboundAdapter" type="CLS"></ProjectItem>
    <ProjectItem name="Demolympics.BO.BucketNdJSON" type="CLS"></ProjectItem>
    <ProjectItem name="Demolympics.BO.CloudBucket" type="CLS"></ProjectItem>
    <ProjectItem name="Demolympics.BP.DeviceCustomBP" type="CLS"></ProjectItem>
    <ProjectItem name="Demolympics.BS.CloudBucket" type="CLS"></ProjectItem>
    <ProjectItem name="Demolympics.BS.DeviceStatusService" type="CLS"></ProjectItem>
    <ProjectItem name="Demolympics.DTL.ObservationtoADTA08" type="CLS"></ProjectItem>
    <ProjectItem name="Demolympics.MSG.Blob" type="CLS"></ProjectItem>
    <ProjectItem name="Demolympics.MSG.DeviceStatusRequest" type="CLS"></ProjectItem>
    <ProjectItem name="Demolympics.MSG.ObservationRequest" type="CLS"></ProjectItem>
    <ProjectItem name="HCC.Connect.Production" type="CLS"></ProjectItem>
    <ProjectItem name="MQTT Device to Patient.LUT" type="LUT"></ProjectItem>
    <ProjectItem name="EnsExportNotes.EnsExportProduction_2025-04-23 13-28-06_055+0.PTD" type="PTD"></ProjectItem>
  </Items>
</Project>


<Class name="HCC.Connect.Production">
<Super>Ens.Production</Super>
<TimeChanged>67318,32765.313052812</TimeChanged>
<TimeCreated>67281,42941.644091371</TimeCreated>

<XData name="ProductionDefinition">
<Data><![CDATA[
<Production Name="HCC.Connect.Production" LogGeneralTraceEvents="false">
  <Description>Health Connect Cloud Base Production</Description>
  <ActorPoolSize>1</ActorPoolSize>
  <Item Name="FHIR to OMOP" Category="OMOP" ClassName="Demolympics.BO.BucketNdJSON" PoolSize="1" Enabled="true" Foreground="false" Comment="" LogTraceEvents="false" Schedule="">
    <Setting Target="Host" Name="BucketName">il-demo-fhir-ndjson-in-to-omop</Setting>
    <Setting Target="Host" Name="DirectoryName">Transactions/</Setting>
    <Setting Target="Adapter" Name="ProviderCredentialsFile">/connect/files/OlimpicsStorageBucket.txt</Setting>
    <Setting Target="Adapter" Name="StorageRegion">us-east-1</Setting>
  </Item>
  <Item Name="FTS to Bucket" Category="OMOP" ClassName="Demolympics.BO.CloudBucket" PoolSize="1" Enabled="true" Foreground="false" Comment="" LogTraceEvents="false" Schedule="">
    <Setting Target="Host" Name="BucketName">il-demo-hl7-in-to-fhir-bucket</Setting>
    <Setting Target="Adapter" Name="ProviderCredentialsFile">/connect/files/OlimpicsStorageBucket.txt</Setting>
    <Setting Target="Adapter" Name="StorageRegion">us-east-1</Setting>
  </Item>
  <Item Name="FTS to FHIR Server" Category="HL7" ClassName="Demolympics.BO.CloudBucket" PoolSize="1" Enabled="true" Foreground="false" Comment="" LogTraceEvents="false" Schedule="">
    <Setting Target="Host" Name="BucketName">il-demo-hl7-in-to-fhir-server</Setting>
    <Setting Target="Adapter" Name="ProviderCredentialsFile">/connect/files/OlimpicsStorageBucket.txt</Setting>
    <Setting Target="Adapter" Name="StorageRegion">us-east-1</Setting>
  </Item>
  <Item Name="Medical Device Process" Category="HL7,OMOP,MQTT" ClassName="Demolympics.BP.DeviceCustomBP" PoolSize="1" Enabled="true" Foreground="false" Comment="" LogTraceEvents="false" Schedule="">
    <Setting Target="Host" Name="IncludeFTS">1</Setting>
  </Item>
  <Item Name="FTS Bucket In" Category="OMOP" ClassName="Demolympics.BS.CloudBucket" PoolSize="1" Enabled="true" Foreground="false" Comment="" LogTraceEvents="false" Schedule="">
    <Setting Target="Adapter" Name="BlobNamePattern">*</Setting>
    <Setting Target="Adapter" Name="BlobNamePrefix">fhir-out</Setting>
    <Setting Target="Adapter" Name="BucketName">il-demo-hl7-in-to-fhir-bucket</Setting>
    <Setting Target="Adapter" Name="ProviderCredentialsFile">/connect/files/OlimpicsStorageBucket.txt</Setting>
    <Setting Target="Adapter" Name="StorageRegion">us-east-1</Setting>
  </Item>
  <Item Name="Medical Device Input" Category="MQTT,HL7,FHIR" ClassName="Demolympics.BS.DeviceStatusService" PoolSize="1" Enabled="true" Foreground="false" Comment="" LogTraceEvents="false" Schedule="">
    <Setting Target="Adapter" Name="BrokerRetryInterval">1</Setting>
    <Setting Target="Adapter" Name="ClientID">InterSystemsIRIS</Setting>
    <Setting Target="Adapter" Name="Topic">/measurements/testari/heartrate</Setting>
    <Setting Target="Adapter" Name="Url">tcp://broker.emqx.io:1883</Setting>
  </Item>
  <Item Name="EMR" Category="Other" ClassName="EnsLib.HL7.Service.TCPService" PoolSize="1" Enabled="true" Foreground="false" Comment="" LogTraceEvents="false" Schedule="">
    <Setting Target="Adapter" Name="Port">5555</Setting>
  </Item>
  <Item Name="To EMR" Category="MQTT" ClassName="EnsLib.HL7.Operation.TCPOperation" PoolSize="1" Enabled="true" Foreground="false" Comment="" LogTraceEvents="false" Schedule="">
    <Setting Target="Adapter" Name="IPAddress">127.0.0.1</Setting>
    <Setting Target="Adapter" Name="Port">5555</Setting>
    <Setting Target="Host" Name="ArchiveIO">1</Setting>
  </Item>
</Production>
]]></Data>
</XData>
</Class>


<Document name="EnsExportNotes.EnsExportProduction_2025-04-23 13-28-06_055+0.PTD"><ProjectTextDocument name="EnsExportNotes.EnsExportProduction_2025-04-23 13-28-06_055+0" description="Export Notes for export EnsExportProduction_2025-04-23 13-28-06_055+0">
<![CDATA[<Deployment>
<Creation>
<Machine>IP-10-0-0-34.A7TFE0EHWVMG</Machine>
<Instance>IRIS</Instance>
<Namespace>DEMOLYMPICS</Namespace>
<SourceProduction>HCC.Connect.Production</SourceProduction>
<Username>arig</Username>
<UTC>2025-04-23 13:28:36.672</UTC>
</Creation>
<Notes>
</Notes>
<Contents>
<ExportProject>EnsExportProduction_2025-04-23 13-28-06_055+0</ExportProject>
<Item num="1">Demolympics.Adapter.CloudStorageInboundAdapter.CLS</Item>
<Item num="2">Demolympics.Adapter.CloudStorageOutboundAdapter.CLS</Item>
<Item num="3">Demolympics.BO.BucketNdJSON.CLS</Item>
<Item num="4">Demolympics.BO.CloudBucket.CLS</Item>
<Item num="5">Demolympics.BP.DeviceCustomBP.CLS</Item>
<Item num="6">Demolympics.BS.CloudBucket.CLS</Item>
<Item num="7">Demolympics.BS.DeviceStatusService.CLS</Item>
<Item num="8">Demolympics.DTL.ObservationtoADTA08.CLS</Item>
<Item num="9">Demolympics.MSG.Blob.CLS</Item>
<Item num="10">Demolympics.MSG.DeviceStatusRequest.CLS</Item>
<Item num="11">Demolympics.MSG.ObservationRequest.CLS</Item>
<Item num="12">HCC.Connect.Production.CLS</Item>
<Item num="13">MQTT Device to Patient.LUT</Item>
</Contents>
<ProductionClassInExport>HCC.Connect.Production</ProductionClassInExport>
</Deployment>

]]></ProjectTextDocument>
</Document>

<Document name="MQTT Device to Patient.LUT">
<lookupTable>
<entry table="MQTT Device to Patient" key="123456789">John|Doe|M|195930727|987654321</entry>
</lookupTable>
</Document></Export>
